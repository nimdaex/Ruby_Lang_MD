---
layout: ../../layouts/MarkdownPostLayout.astro
title: "บทที่ 5: ตัวแปรในภาษา Ruby"
pubDate: 2026-01-19
description: "เรียนรู้แนวคิดและการใช้งานตัวแปรในภาษา Ruby ตั้งแต่การประกาศพื้นฐาน การจัดการข้อมูลด้วย Array ค่าคงที่ ไปจนถึงการรับค่าและการแปลงประเภทข้อมูล"
author: "Web Design Team"
tags: ["Ruby", "Variables", "Data Types", "Basics"]
---

ตัวแปรในภาษา Ruby: ฉบับเรียบเรียงใหม่พร้อมตัวอย่างชุดใหม่ทั้งหมด

## แนวคิดของตัวแปรใน Ruby

ในภาษา Ruby **ตัวแปร** คือที่เก็บข้อมูลในหน่วยความจำที่มี “ชื่อ” เอาไว้ใช้อ้างอิงค่าที่เก็บอยู่ ทำให้โค้ดอ่านง่าย และเปลี่ยนค่าที่ใช้ซ้ำได้โดยไม่ต้องพิมพ์ค่าซ้ำหลายจุดในโปรแกรมเดียวกัน
Ruby อนุญาตให้เก็บข้อมูลได้หลายชนิดในตัวแปรเดียว เช่น จำนวนเต็ม จำนวนทศนิยม ข้อความ อาร์เรย์ ออบเจ็กต์ หรือแม้แต่ผลลัพธ์จากการเรียกเมธอด ทำให้การเขียนโค้ดมีความยืดหยุ่นสูงมาก

รูปแบบพื้นฐานของการกำหนดค่าตัวแปรใน Ruby คือ

```ruby
ชื่อ_ตัวแปร = ค่า
```

ชื่อของตัวแปรจะต้องประกอบด้วยตัวอักษร ตัวเลข และเครื่องหมายขีดล่าง `_` แต่ไม่สามารถขึ้นต้นด้วยตัวเลข เพื่อให้ Ruby แยกแยะได้ชัดเจนว่ากำลังอ้างถึงตัวแปร ไม่ใช่ตัวเลขหรือตัวอื่นในโค้ด

ตัวอย่างการกำหนดตัวแปรแบบง่าย

```ruby
temperature = 32
city_name   = "Bangkok"
is_open     = true
```

ในตัวอย่างนี้ `temperature` เก็บจำนวนเต็ม, `city_name` เก็บ String และ `is_open` เก็บค่าแบบ boolean ซึ่งทั้งหมดสามารถนำไปใช้ต่อในนิพจน์หรือเงื่อนไขต่าง ๆ ได้

## การประกาศและใช้งานตัวแปรพื้นฐาน

ส่วนนี้จะเริ่มจากตัวอย่างเลขง่าย ๆ เพื่อให้เห็นประโยชน์ของตัวแปรก่อน แล้วค่อยต่อยอดไปยังตัวอย่างที่ซับซ้อนขึ้นในโปรแกรมจริง

### ตัวอย่าง: คำนวณส่วนลดอย่างง่าย

```ruby
price      = 1200
discount   = 150
final_cost = price - discount

puts final_cost
```

ผลลัพธ์ที่จะแสดงคือ

```text
1050
```

ในตัวอย่างนี้มีตัวแปรสามตัวคือ `price`, `discount` และ `final_cost` ซึ่งเก็บราคาตั้งต้น จำนวนเงินส่วนลด และราคาสุทธิ เมื่อเรียก `puts final_cost` Ruby จะนำค่าที่คำนวณแล้วมาแสดงบนหน้าจอ ทำให้โค้ดอ่านง่ายกว่าการเขียนเป็นนิพจน์ยาว ๆ ในบรรทัดเดียว

### ตัวอย่าง: ใช้ตัวแปร String ซ้ำหลายครั้ง

```ruby
product = "Coffee Dripper"

puts "Product name: " + product
puts product + " is now in stock."
puts "You can order " + product + " online."
```

ผลลัพธ์ที่จะแสดงคือ

```text
Product name: Coffee Dripper
Coffee Dripper is now in stock.
You can order Coffee Dripper online.
```

ตัวอย่างนี้แสดงให้เห็นว่าการเก็บชื่อสินค้าไว้ในตัวแปร `product` ทำให้สามารถนำไปใช้ซ้ำได้หลายบรรทัด หากต้องการเปลี่ยนชื่อสินค้า ก็เพียงแก้ที่ตัวแปรเดียว โดยไม่ต้องตามไปแก้ทุกข้อความในโค้ด

## การเปลี่ยนแปลงค่าของตัวแปรระหว่างรันโปรแกรม

จุดสำคัญของคำว่า “ตัวแปร” คือค่าที่เก็บอยู่สามารถเปลี่ยนไปได้ตลอดเวลาในขณะโปรแกรมทำงาน ซึ่งทำให้สามารถอัปเดตสถานะหรือผลลัพธ์กลางทางได้

### ตัวอย่าง: คำนวณคะแนนรวมที่เปลี่ยนไปเรื่อย ๆ

```ruby
score      = 0
bonus      = 5

puts "Start score: #{score}"

score = score + 10
puts "After first mission: #{score}"

score = score + bonus
puts "After bonus applied: #{score}"

score = 0
puts "Score reset to: #{score}"
```

ผลลัพธ์ที่ได้เช่น

```text
Start score: 0
After first mission: 10
After bonus applied: 15
Score reset to: 0
```

ในตัวอย่างนี้ `score` ถูกอัปเดตหลายครั้งระหว่างการทำงานของโปรแกรม จากค่าเริ่มต้น ไปจนถึงค่าหลังภารกิจ ค่าหลังบวกโบนัส และสุดท้ายถูกรีเซ็ตกลับไปเป็นศูนย์ แสดงให้เห็นว่าตัวแปรเดียวกันสามารถสะท้อนสถานะที่แตกต่างกันได้ตามลำดับเวลา

### ตัวอย่าง: ใช้ตัวแปรร่วมกับการคำนวณที่เปลี่ยนไป

```ruby
length  = 4
width   = 6

puts "Area: #{length * width}"

length = 7
puts "Area after length changed: #{length * width}"

width  = 0
length = 0

puts "Length now: #{length}"
puts "Width now:  #{width}"
```

ผลที่ได้จะมีลักษณะคล้าย

```text
Area: 24
Area after length changed: 42
Length now: 0
Width now: 0
```

จุดสำคัญของตัวอย่างนี้คือ เมื่อเปลี่ยนค่าในตัวแปร `length` หรือ `width` การคำนวณพื้นที่ในบรรทัดถัดไปก็จะเปลี่ยนตามทันที ทำให้โค้ดสามารถตอบสนองต่อการเปลี่ยนแปลงข้อมูลได้อย่างยืดหยุ่น

## ใช้ตัวแปรจัดการชุดข้อมูลด้วยอาร์เรย์

นอกจากค่าเดี่ยวแล้ว Ruby ยังมี **อาร์เรย์** สำหรับเก็บชุดข้อมูลหลายค่าภายใต้ตัวแปรเดียว โดยสามารถวนลูปเพื่อสรุปผล เช่น หาผลรวม ค่ามากสุด หรือน้อยสุด ได้อย่างเป็นระบบ

### ตัวอย่าง: หายอดขายรวมและค่ามาก–น้อยที่สุด

```ruby
daily_sales = [1200, 850, 2100, 760, 3000, 1950]
total       = 0
max_sale    = daily_sales[0]
min_sale    = daily_sales[0]

daily_sales.each do |amount|
  total    = total + amount
  max_sale = amount if amount > max_sale
  min_sale = amount if amount < min_sale
end

p daily_sales
puts "Total sales = #{total}"
puts "Max sale    = #{max_sale}"
puts "Min sale    = #{min_sale}"
```

ผลลัพธ์จะมีลักษณะใกล้เคียงกับ

```text
[1200, 850, 2100, 760, 3000, 1950]
Total sales = 9860
Max sale    = 3000
Min sale    = 760
```

ตัวแปร `daily_sales` เก็บข้อมูลเป็นอาร์เรย์ของยอดขายรายวัน ในขณะที่ `total`, `max_sale` และ `min_sale` ใช้เก็บผลการคำนวณที่สรุปออกมาจากข้อมูลชุดนี้ การใช้ `each` วนผ่านค่าทุกตัวในอาร์เรย์ช่วยให้เขียนโค้ดได้สั้นและเข้าใจง่าย

สังเกตด้วยว่ามีการใช้ `p` เพื่อแสดงโครงสร้างอาร์เรย์ตรง ๆ ซึ่งมักใช้ในการ debug เพราะจะแสดงประเภทของข้อมูลออกมาชัดเจน ต่างจาก `puts` ที่จะพยายามแสดงผลให้เป็นข้อความอ่านง่าย

## ค่าคงที่ (Constants) ใน Ruby

ค่าคงที่ใน Ruby มีลักษณะคล้ายตัวแปร แต่ **ตั้งใจให้ใช้ค่าคงเดิม** ตลอดอายุของโปรแกรม เช่น ค่า PI หรือชื่อเว็บไซต์ เมื่อประกาศแล้วไม่ควรเปลี่ยน แม้ Ruby จะอนุญาตให้เปลี่ยนได้แต่จะมีคำเตือนเมื่อทำเช่นนั้น

รูปแบบการประกาศค่าคงที่คือ

```ruby
NAME = value
```

โดยชื่อจะต้องขึ้นต้นด้วยตัวพิมพ์ใหญ่ ถ้าตั้งชื่อขึ้นต้นด้วยตัวพิมพ์ใหญ่ Ruby จะมองว่าคือค่าคงที่ทันที

### ตัวอย่าง: ใช้ค่าคงที่ในการคำนวณทางเรขาคณิต

```ruby
PI      = 3.14159
radius  = 7

puts "Circle area:        #{PI * (radius ** 2)}"
puts "Circle perimeter:   #{2 * PI * radius}"

sphere_volume = (4.0 / 3.0) * PI * (radius ** 3)
sphere_area   = 4 * PI * (radius ** 2)

puts "Sphere volume:      #{sphere_volume}"
puts "Sphere surface:     #{sphere_area}"
```

ค่าคงที่ `PI` ถูกใช้ซ้ำหลายครั้งทั้งในการคำนวณพื้นที่วงกลม เส้นรอบวง ปริมาตรทรงกลม และพื้นที่ผิวทรงกลม หากต้องการเปลี่ยนค่าประมาณของ PI ก็เพียงปรับค่าที่บรรทัดเดียว โค้ดส่วนอื่น ๆ จะใช้ค่าที่อัปเดตตามไปโดยอัตโนมัติ

### ตัวอย่าง: การเปลี่ยนค่าคงที่และคำเตือน

```ruby
SITE_TITLE = "Ruby Learning Center"
puts "Welcome to #{SITE_TITLE}"

SITE_TITLE = "Advanced Ruby Lab"
```

เมื่อรันจะได้ข้อความต้อนรับตามค่าครั้งแรก และ Ruby จะเตือนในลักษณะว่าได้มีการกำหนดค่าคงที่ `SITE_TITLE` ซ้ำ โดยแจ้งบรรทัดที่ประกาศใหม่และประกาศเดิม ทำให้ผู้เขียนโค้ดเห็นชัดว่ากำลังละเมิดเจตนารมณ์ของค่าคงที่

## การรับค่าจากคีย์บอร์ดและเก็บไว้ในตัวแปร

Ruby มีเมธอด `gets` สำหรับอ่านข้อมูลจากคีย์บอร์ด ซึ่งจะคืนค่าเป็น String เสมอ จึงมักต้องแปลงชนิดข้อมูลก่อนนำไปคำนวณเชิงตัวเลข ตัวแปรจึงมีบทบาททั้งในการรับค่าเก็บไว้ และใช้เป็นส่วนประกอบของนิพจน์

### ตัวอย่าง: คำนวณดัชนีมวลกาย (BMI)

```ruby
puts  "BMI calculator"
print "Enter weight (kg): "
weight = gets.chomp.to_f

print "Enter height (cm): "
height_cm = gets.chomp.to_f

height_m  = height_cm / 100.0
bmi       = weight / (height_m ** 2)

puts "Your BMI is #{bmi}"
```

จุดสำคัญในตัวอย่างนี้คือ

- ใช้ `gets.chomp` เพื่อตัดอักขระขึ้นบรรทัดใหม่ออกจากข้อมูลที่รับเข้ามา
- ใช้ `to_f` แปลง String เป็นจำนวนจริง เพื่อให้สามารถคำนวณทางคณิตศาสตร์ได้อย่างถูกต้อง
- ตัวแปร `height_m` ทำหน้าที่เป็นตัวกลางในการแปลงหน่วยจากเซนติเมตรเป็นเมตร ก่อนนำไปใช้ในสูตร BMI

### ตัวอย่าง: คำนวณระยะทางตามเวลาเดินทาง

```ruby
puts  "Travel distance estimator"
print "Enter speed (km/h): "
speed = gets.chomp.to_f

print "Enter time (hours): "
time = gets.chomp.to_f

distance = speed * time

puts "Estimated distance: #{distance} km"
```

การใช้ตัวแปร `speed`, `time` และ `distance` ทำให้สูตรคำนวณ `speed * time` อ่านง่ายและมีความหมาย ตัวแปรจึงไม่ได้แค่เก็บตัวเลข แต่ช่วยสื่อความตั้งใจของโค้ดต่อผู้อ่านด้วย

## การแปลงประเภทข้อมูล (Type Conversion)

ใน Ruby เมธอดสำหรับแปลงชนิดข้อมูลเป็นสิ่งที่ใช้งานบ่อย เช่น การแปลงตัวเลขเป็นข้อความ หรือแปลงข้อความให้กลายเป็นตัวเลขก่อนคำนวณ การแปลงเหล่านี้มักเรียกผ่านเมธอดที่ขึ้นต้นด้วย `to_` เช่น `to_i`, `to_f`, `to_s`

### ตัวอย่าง: การแปลงชนิดข้อมูลหลากหลายรูปแบบ

```ruby
puts "Number conversions"
p  9.8.to_i
p  12.to_f
p  12.to_s
p  4.to_c
p  4.to_r

puts "String conversions"
p "42.75".to_i
p "42.75".to_f
p "42.75".to_c
p "42.75".to_r
p "ruby-lang".to_i
```

เมธอดสำคัญในตัวอย่างนี้ได้แก่

- `to_i` แปลงเป็นจำนวนเต็ม เช่น `"42.75".to_i` จะให้ค่า 42
- `to_f` แปลงเป็นจำนวนทศนิยม เช่น `"42.75".to_f` จะให้ค่า 42.75
- `to_s` แปลงเป็น String เพื่อใช้รวมข้อความหรือแสดงผล
- `to_c` แปลงเป็นจำนวนเชิงซ้อน (Complex) และ `to_r` แปลงเป็นเศษส่วน (Rational)

เมื่อเรียก `to_i` บน String ที่ไม่ใช่ตัวเลข เช่น `"ruby-lang".to_i` ผลลัพธ์จะเป็น 0 สะท้อนให้เห็นว่าการแปลงค่าที่ไม่ใช่ตัวเลขจะไม่ทำให้เกิดข้อผิดพลาดทันที แต่ให้ค่าเริ่มต้นแทน

### ตัวอย่าง: โปรแกรมคิดราคาสินค้าหลายประเภท

```ruby
print "How many notebooks?: "
notebooks = gets.chomp.to_i

print "How many pens?: "
pens = gets.chomp.to_i

total = (notebooks * 25) + (pens * 12)

puts "Total to pay: #{total} THB"
```

การใช้ `to_i` หลัง `gets.chomp` ช่วยแปลงจำนวนที่ผู้ใช้ป้อนจาก String ให้กลายเป็นตัวเลข ก่อนนำไปคูณกับราคาและบวกเป็นยอดรวม ถ้าไม่แปลงเป็นตัวเลข นิพจน์คณิตศาสตร์จะทำงานไม่ได้อย่างถูกต้อง

### การใช้ตัวดำเนินการ `*` กับตัวเลขและ String

```ruby
puts 7 * 4
puts "7" * 4
puts "Hi" * 3
# puts 4 * "7"  # จะทำให้เกิดข้อผิดพลาดถ้าเอาคอมเมนต์ออก
```

- บรรทัดแรก `7 * 4` เป็นการคูณตัวเลขปกติ
- บรรทัดที่สอง `"7" * 4` คือการทำซ้ำ String `"7"` รวมกัน 4 ครั้ง
- ถ้าพยายามเขียน `4 * "7"` จะเกิดข้อผิดพลาด เพราะ Ruby ไม่รองรับการคูณโดยให้ตัวเลขเป็นตัวแปรตัวแรกและ String เป็นตัวหลังในกรณีนี้

ตัวอย่างนี้ชี้ให้เห็นว่าประเภทข้อมูลของตัวแปรส่งผลต่อความหมายของตัวดำเนินการเดียวกันอย่างไร

## เมธอดที่ใช้ตรวจสอบและทำงานกับตัวแปร

Ruby มีเมธอดหลายตัวที่ช่วยให้ตรวจสอบสถานะของตัวแปรได้ เช่น ดูว่ามีตัวแปรอะไรอยู่ในสโคปปัจจุบัน หรือตัวแปรนั้นเป็นชนิดข้อมูลใด ซึ่งเป็นประโยชน์ทั้งด้านความเข้าใจโค้ดและการ debug

### ตัวอย่าง: ตรวจสอบตัวแปรและชนิดข้อมูล

```ruby
username = "admin"
max_retry = 3

def check_local_vars
  attempt = 1
  status  = "pending"
  p local_variables
end

# แสดงตัวแปร local ทั้งหมดในสโคประดับบน
p local_variables

# ตรวจสอบว่าตัวแปรถูกประกาศแล้วหรือยัง
p local_variables.include?(:username)
p local_variables.include?(:password)

# ตรวจสอบชนิดของตัวแปร
p username.class
p max_retry.class

# ตรวจสอบว่าตัวแปรเป็นชนิดที่ต้องการหรือไม่
p username.instance_of?(String)
p max_retry.instance_of?(Integer)
p [true, false].instance_of?(Array)

# เรียกใช้เมธอดเพื่อดูตัวแปร local ภายในเมธอด
check_local_vars
```

สิ่งที่เกิดขึ้นในตัวอย่างนี้คือ

- `local_variables` คืนค่าเป็นอาร์เรย์ของ symbol ที่แทนชื่อตัวแปร local ทั้งหมดในสโคปปัจจุบัน
- สามารถใช้ `include?` กับอาร์เรย์นั้นเพื่อตรวจสอบว่ามีตัวแปรชื่อที่ต้องการอยู่หรือไม่ เช่น `:username` หรือ `:password`
- `class` ใช้ดูประเภทของค่าที่เก็บในตัวแปร เช่น `String`, `Integer`, `Array`
- `instance_of?` ใช้ตรวจสอบว่าค่าที่เก็บนั้นเป็นออบเจ็กต์ของคลาสที่ระบุอย่างตรงตัวหรือไม่ เช่น `username.instance_of?(String)`

เมื่อเรียก `check_local_vars` แล้วใช้ `local_variables` ภายในเมธอด จะเห็นว่ารายการตัวแปรที่ได้จะเป็นเฉพาะตัวแปร local ภายในเมธอดนั้น แสดงให้เห็นแนวคิดของ “ขอบเขตของตัวแปร” ซึ่งเป็นหัวข้อสำคัญต่อไปในลำดับการเรียน Ruby

***

โครงสร้างและตัวอย่างทั้งหมดนี้สะท้อนแนวคิดเรื่องตัวแปรในภาษา Ruby ตั้งแต่พื้นฐานอย่างการประกาศตัวแปร การเปลี่ยนค่า การใช้กับอาร์เรย์และค่าคงที่ การรับค่าจากคีย์บอร์ด การแปลงประเภทข้อมูล ไปจนถึงการใช้เมธอดเพื่อตรวจสอบตัวแปรและชนิดข้อมูล ซึ่งเป็นรากฐานสำคัญก่อนจะก้าวไปสู่เรื่องขอบเขตของตัวแปรและรูปแบบตัวแปรชนิดอื่น ๆ ใน Ruby ต่อไป

[อ้างอิงต้นฉบับ](https://marcuscode.com/lang/ruby/variables-basic)